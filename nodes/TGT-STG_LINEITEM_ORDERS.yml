fileVersion: 1
id: feeb0bae-17d5-4378-af3c-1da9a6761241
name: STG_LINEITEM_ORDERS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests:
          isDistinct: false
        columnReference:
          columnCounter: aa60a372-ffb7-486a-b3c3-2c82e9f80e5d
          stepCounter: feeb0bae-17d5-4378-af3c-1da9a6761241
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: ORDER_CUSTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13b03860-7074-4369-a476-e92af2b0146b
                stepCounter: a840e5d7-7e96-4f84-a065-447bf014ede1
            transform: ""
      - appliedColumnTests:
          isDistinct: false
        columnReference:
          columnCounter: 4242898c-d12b-43a0-9355-905e7a979826
          stepCounter: feeb0bae-17d5-4378-af3c-1da9a6761241
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: LINEITEM_PARTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f1152ed4-b646-46e8-9b09-89f6b26b643b
                stepCounter: 664febd0-8db7-4a6a-abaa-d96bb81eb5de
            transform: ""
      - appliedColumnTests:
          isDistinct: false
        columnReference:
          columnCounter: 6a0f197c-ea0a-4374-bb2e-9b147aff692a
          stepCounter: feeb0bae-17d5-4378-af3c-1da9a6761241
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: LINEITEM_SUPPKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 58579731-a72e-4db0-802e-99108885b530
                stepCounter: 664febd0-8db7-4a6a-abaa-d96bb81eb5de
            transform: ""
      - appliedColumnTests:
          isDistinct: false
        columnReference:
          columnCounter: 6623ae71-2377-4053-bd35-b9199347962a
          stepCounter: feeb0bae-17d5-4378-af3c-1da9a6761241
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: LINEITEM_ORDERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 135e5dbb-9e4d-4002-9871-086fe6f45a1b
                stepCounter: 664febd0-8db7-4a6a-abaa-d96bb81eb5de
            transform: ""
      - appliedColumnTests:
          isDistinct: false
        columnReference:
          columnCounter: 6cec1104-057b-4c39-b5cf-ef389bd0bc8b
          stepCounter: feeb0bae-17d5-4378-af3c-1da9a6761241
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: LINEITEM_LINENUMBER
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b7ffe19-c2d7-442d-968f-36e51ed91604
                stepCounter: 664febd0-8db7-4a6a-abaa-d96bb81eb5de
            transform: ""
      - appliedColumnTests:
          isDistinct: false
        columnReference:
          columnCounter: 4562105c-f5b2-4e0c-8011-14d08d5311ca
          stepCounter: feeb0bae-17d5-4378-af3c-1da9a6761241
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: LINEITEM_QUANTITY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 276a6627-d9ad-47e8-ae8b-4856727210dd
                stepCounter: 664febd0-8db7-4a6a-abaa-d96bb81eb5de
            transform: ""
      - appliedColumnTests:
          isDistinct: false
        columnReference:
          columnCounter: 7014b0fc-d103-476a-a92d-54af90378fe5
          stepCounter: feeb0bae-17d5-4378-af3c-1da9a6761241
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: LINEITEM_EXTENDEDPRICE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd80b964-5988-4894-a6e7-5ef0ad99c732
                stepCounter: 664febd0-8db7-4a6a-abaa-d96bb81eb5de
            transform: ""
      - appliedColumnTests:
          isDistinct: false
        columnReference:
          columnCounter: 4f403561-6323-43b8-8e42-c209820f7735
          stepCounter: feeb0bae-17d5-4378-af3c-1da9a6761241
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: LINEITEM_DISCOUNT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bdc85241-cd5b-4d0e-bc92-e4618ae4a040
                stepCounter: 664febd0-8db7-4a6a-abaa-d96bb81eb5de
            transform: ""
      - appliedColumnTests:
          isDistinct: false
        columnReference:
          columnCounter: 9db62edb-2c78-4382-a1d2-285efee62977
          stepCounter: feeb0bae-17d5-4378-af3c-1da9a6761241
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: LINEITEM_TAX
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3dbb6dd1-5f0f-4e5d-a099-508b1199ab74
                stepCounter: 664febd0-8db7-4a6a-abaa-d96bb81eb5de
            transform: ""
      - appliedColumnTests:
          isDistinct: false
        columnReference:
          columnCounter: d8495e4e-986e-478f-85fe-7357632345bb
          stepCounter: feeb0bae-17d5-4378-af3c-1da9a6761241
        config: {}
        dataType: string
        description: ""
        name: LINEITEM_RETURNFLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ecb577bb-d61a-4b34-9c20-d3817cac0644
                stepCounter: 664febd0-8db7-4a6a-abaa-d96bb81eb5de
            transform: ""
      - appliedColumnTests:
          isDistinct: false
        columnReference:
          columnCounter: 64ee7a3c-c7f3-4482-a7f0-62c4a2df4f80
          stepCounter: feeb0bae-17d5-4378-af3c-1da9a6761241
        config: {}
        dataType: string
        description: ""
        name: LINEITEM_LINESTATUS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9fab8854-15f8-416f-b393-2e51af9eb2ad
                stepCounter: 664febd0-8db7-4a6a-abaa-d96bb81eb5de
            transform: ""
      - appliedColumnTests:
          isDistinct: false
        columnReference:
          columnCounter: 1bd6fc56-495f-4ec3-8b6b-b0c83cc8e81d
          stepCounter: feeb0bae-17d5-4378-af3c-1da9a6761241
        config: {}
        dataType: DATE
        description: ""
        name: LINEITEM_SHIPDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f4c9261-7f46-4e52-9710-52efeac493aa
                stepCounter: 664febd0-8db7-4a6a-abaa-d96bb81eb5de
            transform: ""
      - appliedColumnTests:
          isDistinct: false
        columnReference:
          columnCounter: d0dca91e-bd1d-43f0-bf94-6e2005d9bb02
          stepCounter: feeb0bae-17d5-4378-af3c-1da9a6761241
        config: {}
        dataType: DATE
        description: ""
        name: LINEITEM_COMMITDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e80b4742-2e4d-413d-8bec-ebfd5bf76430
                stepCounter: 664febd0-8db7-4a6a-abaa-d96bb81eb5de
            transform: ""
      - appliedColumnTests:
          isDistinct: false
        columnReference:
          columnCounter: bf676264-64a6-47aa-b716-8a1b50c47b07
          stepCounter: feeb0bae-17d5-4378-af3c-1da9a6761241
        config: {}
        dataType: DATE
        description: ""
        name: LINEITEM_RECEIPTDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c58b8c05-657b-4002-90f6-7dc03c506b44
                stepCounter: 664febd0-8db7-4a6a-abaa-d96bb81eb5de
            transform: ""
      - appliedColumnTests:
          isDistinct: false
        columnReference:
          columnCounter: 5e399f1a-d86c-4be7-826d-31cc5d84dbab
          stepCounter: feeb0bae-17d5-4378-af3c-1da9a6761241
        config: {}
        dataType: string
        description: ""
        name: LINEITEM_SHIPINSTRUCT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a72d5c0b-3e19-4ecc-8848-c4c994c2d2c5
                stepCounter: 664febd0-8db7-4a6a-abaa-d96bb81eb5de
            transform: ""
      - appliedColumnTests:
          isDistinct: false
        columnReference:
          columnCounter: 5d8c8a16-e478-4b6b-b213-ad91c9c855db
          stepCounter: feeb0bae-17d5-4378-af3c-1da9a6761241
        config: {}
        dataType: string
        description: ""
        name: LINEITEM_SHIPMODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b52a437-72cd-4776-bde1-a2594057093e
                stepCounter: 664febd0-8db7-4a6a-abaa-d96bb81eb5de
            transform: ""
      - appliedColumnTests:
          isDistinct: false
        columnReference:
          columnCounter: 36266e0b-00ae-4137-a207-7f5374c35a8e
          stepCounter: feeb0bae-17d5-4378-af3c-1da9a6761241
        config: {}
        dataType: string
        description: ""
        name: LINEITEM_COMMENT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0cabcd5-4583-4992-aa83-2bfff3862ed7
                stepCounter: 664febd0-8db7-4a6a-abaa-d96bb81eb5de
            transform: ""
      - appliedColumnTests:
          isDistinct: false
        columnReference:
          columnCounter: 2b8eb277-877c-4e56-b622-18fe0fadac4a
          stepCounter: feeb0bae-17d5-4378-af3c-1da9a6761241
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: ORDER_ORDERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a94f87a-9e96-4e20-b364-8e4e0cf34945
                stepCounter: a840e5d7-7e96-4f84-a065-447bf014ede1
            transform: ""
      - appliedColumnTests:
          isDistinct: false
        columnReference:
          columnCounter: 59c81cc5-7d5b-4d8a-b84e-403568c8a751
          stepCounter: feeb0bae-17d5-4378-af3c-1da9a6761241
        config: {}
        dataType: string
        description: ""
        name: ORDER_ORDERSTATUS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20150eb3-e767-472a-8ad6-3e9459764afa
                stepCounter: a840e5d7-7e96-4f84-a065-447bf014ede1
            transform: ""
      - appliedColumnTests:
          isDistinct: false
        columnReference:
          columnCounter: c128bdb6-6536-4ae8-90ee-dabd9be00a29
          stepCounter: feeb0bae-17d5-4378-af3c-1da9a6761241
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: ORDER_TOTALPRICE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4958b96-dff2-4916-a628-bf0cf970589c
                stepCounter: a840e5d7-7e96-4f84-a065-447bf014ede1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af578f2d-2d20-4978-a971-88251a63a63b
          stepCounter: feeb0bae-17d5-4378-af3c-1da9a6761241
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: ORDER_TOTAL_ORDER_PRICE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4958b96-dff2-4916-a628-bf0cf970589c
                stepCounter: a840e5d7-7e96-4f84-a065-447bf014ede1
            transform: CASE WHEN "STG_LINEITEM"."L_LINENUMBER"=1 THEN "L_LINENUMBER" ELSE 0 END
      - appliedColumnTests:
          isDistinct: false
        columnReference:
          columnCounter: 22528ef4-72c5-4738-b5e5-bf938d0bd7c6
          stepCounter: feeb0bae-17d5-4378-af3c-1da9a6761241
        config: {}
        dataType: DATE
        description: ""
        name: ORDER_ORDERDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0a0ead2-fd12-4deb-9548-349af6a8dc6d
                stepCounter: a840e5d7-7e96-4f84-a065-447bf014ede1
            transform: ""
      - appliedColumnTests:
          isDistinct: false
        columnReference:
          columnCounter: c56ff6a9-a8ef-4911-b30c-678e86798ee2
          stepCounter: feeb0bae-17d5-4378-af3c-1da9a6761241
        config: {}
        dataType: string
        description: ""
        name: ORDER_ORDERPRIORITY_NUM
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94d3c775-f514-4e78-8274-142086bffe72
                stepCounter: a840e5d7-7e96-4f84-a065-447bf014ede1
            transform: SPLIT_PART("STG_ORDERS"."O_ORDERPRIORITY",'-',1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb78d847-1630-4109-bf13-b86bbb2b331b
          stepCounter: feeb0bae-17d5-4378-af3c-1da9a6761241
        config: {}
        dataType: string
        description: ""
        name: ORDER_ORDERPRIORITY_DESC
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94d3c775-f514-4e78-8274-142086bffe72
                stepCounter: a840e5d7-7e96-4f84-a065-447bf014ede1
            transform: SPLIT_PART("STG_ORDERS"."O_ORDERPRIORITY",'-',2)
      - appliedColumnTests:
          isDistinct: false
        columnReference:
          columnCounter: 5747f8dd-c9fa-481a-b08d-f6fe34bc0b87
          stepCounter: feeb0bae-17d5-4378-af3c-1da9a6761241
        config: {}
        dataType: string
        description: ""
        name: ORDER_CLERK
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da27e541-50be-4d9e-962d-7bf73cb3bf37
                stepCounter: a840e5d7-7e96-4f84-a065-447bf014ede1
            transform: ""
      - appliedColumnTests:
          isDistinct: false
        columnReference:
          columnCounter: 985c3cc9-2928-4c87-9c41-492cfc14dd74
          stepCounter: feeb0bae-17d5-4378-af3c-1da9a6761241
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: ORDER_SHIPPRIORITY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 134582f1-3729-43b7-8ce4-51a92f4dbbd1
                stepCounter: a840e5d7-7e96-4f84-a065-447bf014ede1
            transform: ""
      - appliedColumnTests:
          isDistinct: false
        columnReference:
          columnCounter: 61187933-e2e2-49df-94c0-daafcb099769
          stepCounter: feeb0bae-17d5-4378-af3c-1da9a6761241
        config: {}
        dataType: string
        description: ""
        name: ORDER_COMMENT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33811451-c694-4054-ad55-385da589299a
                stepCounter: a840e5d7-7e96-4f84-a065-447bf014ede1
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 1d869647-a5ea-47e9-8e9b-15eefac6a3d5
          stepCounter: feeb0bae-17d5-4378-af3c-1da9a6761241
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: DAYS_TO_SHIP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: DATEDIFF("DAY","STG_ORDERS".O_ORDERDATE,STG_LINEITEM.L_SHIPDATE)
        systemColumnType: None
      - acceptedValues:
          strictMatch: false
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 05421fd3-8250-47d5-ac58-bc2b39505aeb
          stepCounter: feeb0bae-17d5-4378-af3c-1da9a6761241
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PS_AVAILQTY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce05c577-6a47-48a7-bfda-9a9795c9f35a
                stepCounter: 664febd0-8db7-4a6a-abaa-d96bb81eb5de
            transform: ""
      - acceptedValues:
          strictMatch: false
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 97604637-0e30-48c2-897e-c72a35f8cddf
          stepCounter: feeb0bae-17d5-4378-af3c-1da9a6761241
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: PS_SUPPLYCOST
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9f5dfba-e6c6-455f-9d99-437ecb8c4ca9
                stepCounter: 664febd0-8db7-4a6a-abaa-d96bb81eb5de
            transform: ""
    cteString: ""
    enabledColumnTestIDs:
      - isDistinct
    sourceMapping:
      - aliases:
          STG_LINEITEM: 664febd0-8db7-4a6a-abaa-d96bb81eb5de
          STG_ORDERS: a840e5d7-7e96-4f84-a065-447bf014ede1
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: STG_LINEITEM
          - locationName: TGT
            nodeName: STG_ORDERS
        join:
          joinCondition: |-
            FROM {{ ref('TGT', 'STG_LINEITEM') }} "STG_LINEITEM"
            INNER JOIN {{ ref('TGT', 'STG_ORDERS') }} "STG_ORDERS"
            ON "STG_LINEITEM"."L_ORDERKEY" = "STG_ORDERS"."O_ORDERKEY"
        name: STG_LINEITEM_ORDERS
        noLinkRefs: []
  name: STG_LINEITEM_ORDERS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
